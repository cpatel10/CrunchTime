<!DOCTYPE html>

<html>
<head>

    <meta name="viewport" content="user-scalable=no, width=device-width, height=device-height, initial-scale=1" >
    <link rel="stylesheet" type="text/css" href="css/index.css" />
    <link rel="stylesheet" type="text/css" href="css/style.css" />
    <link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css" />


    <!-- temporarily moved to head whilst we develop app...-->
    <script type="text/javascript" src="js/index.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.0/jquery.min.js"></script>
    <script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>

    <script type="text/javascript" src="js/index.js"></script>
    <script type="text/javascript" src="js/crunchtime.js"></script>
    <script src="cordova.js"></script>
    <script>

      var db = null;

      document.addEventListener('deviceready', function() {
        
        function onDeviceReady() {
          navigator.geolocation.getCurrentPosition(onSuccess, onError);
        }

        db = window.sqlitePlugin.openDatabase({name: 'mydb7.db', location: 'default'});
        
        populateDB();
        db.transaction(queryDB, errorCB);
      });

      function onSuccess(position) {
        var element = document.getElementById('geolocation');
        element.innerHTML = 'Latitude: '           + position.coords.latitude              + '<br />' +
                            'Longitude: '          + position.coords.longitude             + '<br />' +
                            'Altitude: '           + position.coords.altitude              + '<br />' +
                            'Accuracy: '           + position.coords.accuracy              + '<br />' +
                            'Altitude Accuracy: '  + position.coords.altitudeAccuracy      + '<br />' +
                            'Heading: '            + position.coords.heading               + '<br />' +
                            'Speed: '              + position.coords.speed                 + '<br />' +
                            'Timestamp: '          +                                   position.timestamp          + '<br />';
      }

      // onError Callback receives a [PositionError](PositionError/positionError.html) object
      //
      function onError(error) {
          alert('code: '    + error.code    + '\n' +
                'message: ' + error.message + '\n');
      }

      var watchID = navigator.geolocation.watchPosition(onSuccess, onError, { timeout: 30000 });

      function populateDB() {
        db.transaction(function(tx) {
          tx.executeSql('DROP TABLE IF EXISTS FoodItem');
          tx.executeSql('CREATE TABLE IF NOT EXISTS FoodItem (name, minutes, store, ingredients, link, latitude, longitude)');
          tx.executeSql('INSERT INTO FoodItem VALUES (?,?,?,?,?,?,?)',
            ['Burrito Bowl', 15, 'Chipotle', 'Salsa Pico de Gallo pinto beans rotisserie chicken tortillas cilantro white rice Monterey jack cheese guacamole','../www/img/burritoBowl.jpg', 42.002776, -87.660919]);
          tx.executeSql('INSERT INTO FoodItem VALUES (?,?,?,?,?,?,?)',
            ['Crispy Corn Tacos', 20, 'Taco Bell', 'Crispy taco shells white cheddar jack cheese corn salsa lettuce boneless chicken breasts taco seasoning paprika', '../www/img/taco.jpg', 42.000100, -87.660321]);
          tx.executeSql('INSERT INTO FoodItem VALUES (?,?,?,?,?,?,?)',
            ['Quarter Pounder', 25, 'McDonalds', 'Beef patty sesame seed bun American cheese ketchup pickles slices onions mustard', '../www/img/burger.jpg', 41.995748, -87.659353]);
          tx.executeSql('INSERT INTO FoodItem VALUES (?,?,?,?,?,?,?)',
            ['Salad Bowl', 40, 'You', 'romaine spinach brussel sprouts sweet potato cucumber carrots avocado onions tomatoes olive oil', '../www/img/salad.jpg', 41.999934, -87.660238]);
          tx.executeSql('INSERT INTO FoodItem VALUES (?,?,?,?,?,?,?)',
            ['Fries', 20, 'Bop\'N Grill', 'potatoes vegetable oil', '../www/img/frenchfries.png', 42.002830, -87.660926]);
          tx.executeSql('INSERT INTO FoodItem VALUES (?,?,?,?,?,?,?)',
            ['Sandwich', 13, 'Subway', 'Artisan grilled chicken filet artisan roll tomato slice lettuce vinaigrette sauce herb seasoning','../www/img/sandwich.jpg', 41.999757, -87.660311]);
          tx.executeSql('INSERT INTO FoodItem VALUES (?,?,?,?,?,?,?)',
            ['Chicken Wrap', 35, 'You', 'chicken breast olive oil garlic sour cream dressing cherry tomatoes romaine lettuce croutons tortillas', '../www/img/wrap.jpg', 41.999934, -87.660238]);
          tx.executeSql('INSERT INTO FoodItem VALUES (?,?,?,?,?,?,?)',
            ['Pizza', 15, 'Blaze', 'White cream sauce with mozzarella Applewood bacon chopped garlic oregano arugula','../www/img/pizza.jpg', 42.001662, -87.660960]);
            tx.executeSql('INSERT INTO FoodItem VALUES (?,?,?,?,?,?,?)',
                    ['Pie Pizza', 15, 'Blaze', 'Mozzarella parmesan red sauce','../www/img/pizza.jpg', 42.001662, -87.660960]);
            tx.executeSql('INSERT INTO FoodItem VALUES (?,?,?,?,?,?,?)',
                    ['BBQ Chicken Pizza', 15, 'Blaze', 'Grilled chicken mozzarella red onion banana peppers gorgonzola bbq sauce drizzle','../www/img/pizza.jpg', 42.001662, -87.660960]);
            tx.executeSql('INSERT INTO FoodItem VALUES (?,?,?,?,?,?,?)',
                    ['Green Stripe Pizza', 15, 'Blaze', 'Pesto drizzle over grilled chicken roasted red peppers chopped garlic mozzarella arugula','../www/img/pizza.jpg', 42.001662, -87.660960]);
        }, function(error) {
          alert('Transaction ERROR: ' + error.message);
        }, function() {
          alert('Populated database OK');
        });
      }

      function queryDB(tx) {
        tx.executeSql('SELECT * FROM FoodItem', [], querySuccess, errorCB);
      }

      function errorCB(err) {
        alert("Error processing SQL: "+err.code);
      }

      function querySuccess(tx, results) {

        var foodItemIndexText = '';
        var len = results.rows.length;
        for (var i = 0; i < len; i++) {
          if (i%2 == 0) {
            var foodItemText = '<div class="ui-block-a">';
          } else {
            var foodItemText = '<div class="ui-block-b">';
          }
          
          foodItemText += '<a href="#"><img src="'
                        + results.rows.item(i).link
                        + '" class="ui-li-thumb"></a><span><p>' 
                        + results.rows.item(i).name 
                        + '<br>by <a href="#popupMap" data-rel="popup">' 
                        + results.rows.item(i).store + '</a></p></span>';
          foodItemText += "</div>";
          foodItemIndexText += foodItemText;
        }
        
        document.getElementById("food-item-list").innerHTML = foodItemIndexText;
      }

      function goSearch() {   
        db.transaction(searchQueryDB, errorCB);
      }

      function searchQueryDB(tx) {
        tx.executeSql("SELECT * FROM FoodItem where name like ('%"+ document.getElementById("search-basic").value + "%')", [], querySuccess, errorCB);
      }

      $(document).ready(function(){
        $("#time-selector").change(function() {
          filterFoodItems();
      });

      function filterFoodItems(){
        db.transaction(filterQueryDB, errorCB);
      }

      function filterQueryDB(tx) {
        var desiredTime = $("#time-selector").val();
        if (desiredTime <= 60) {
          tx.executeSql("SELECT * FROM FoodItem where minutes <= " + desiredTime, [], querySuccess, errorCB);
        } else {
          db.transaction(queryDB, errorCB);
        }
      }
});
      

    </script>

    <title>CrunchTime</title>
</head>
<body>

<!-- page1 -->
    <div data-role="page" id="homePage">
        <div id="header" data-role="header" content="ui-content" >
            <h1>CrunchTime</h1>
                 <span data-role="button" class="ui-btn ui-btn-right ui-corner-all ui-icon-bars ui-btn-icon-notext"style= "margin-top: 8px" onclick="menuContentShow()">Bars Icon</span>
                    <ul class= "one nav-menu" data-role="listview" data-inset="true" data-transition="slidedown">
                        <li data-icon="false"><a href="#loginPage" data-rel="popup" data-position-to="window" data-transition="pop">Login</a></li>
                        <li data-icon="false"><a href="#signUpPage" data-rel="popup" data-position-to="window" data-transition="pop">Register</a></li>
                        <li data-icon="false"><a href="#myPage">My Page</a></li>
                        <li data-icon="false"><a href="#aboutUsPage">About Us</a></li>
                    </ul>
        </div>




        <div class="tp">
        <div id="time1" content="ui-content">
                <label for="time1">Have these items in </label></div>
                <div id="time1-o">
                <select name="time" id="time-selector" data-inline="true" data-mini="true">
                    <option value="30">30 mins</option>
                    <option value="15">15 mins</option>
                    <option value="45">45 mins</option>
                    <option value="60">1 hour</option>
                    <option value="61"> > 1 hour</option>
                </select>
                    </div>
            </div>

            <p id="geolocation">Finding geolocation...</p>

            

            <div data-role="popup" id="popupMap" data-overlay-theme="b" data-theme="b" data-corners="false" data-tolerance="15,15">
 
              <a href="#" data-rel="back" data-role="button" data-theme="b" data-icon="delete" data-iconpos="notext" class="ui-btn-right">Close</a>
           
              <iframe src="map.html" width="480" height="320" seamless></iframe>
           
            </div>

            <div class="search">
              <label for="search-basic" class="ui-hidden-accessible" data-mini="true">Search Input:</label>
              <form action="javascript:goSearch();">
                <input type="search" name="search" id="search-basic" placeholder="search" style="text-align: center" />
              </form>
            </div>


            <div class="advancedSearch"><p><a href="#searchPage">Advanced Search</a></p></div>



        <div data-role="main" content="ui-content">
            <div class="ui-grid-x">
              <div id="food-item-list"></div>   
            </div>
         </div>
<!--Login Popup-->
        <div data-role="popup"  id="loginPage" class="ui-content">
            <a href="#" data-rel="back" class="ui-btn ui-corner-all ui-shadow ui-btn ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a>
            <form id ="login" method="post" action="#myPage">
                <h3>Login/ <a href="#signUpPage">Sign Up</a></h3>
                <label for="usrnm" class="ui-hidden-accessible">Username:</label>
                <input type="text" name="user" id="usrnm" placeholder="Username" data-mini="true">
                <label for="pswd" class="ui-hidden-accessible">Password:</label>
                <input type="password" name="pswd" id="pswd" placeholder="Password" data-mini="true">
                <label for="log">Keep me logged in</label>
                <input type="checkbox" name="login" id="log" value="1" data-mini="true"><br>
                <input type="submit" data-inline="true" value="Log in" data-mini="true">
            </form>
        </div>


<!--sign up popup-->
        <div data-role="popup" id="signUpPage">
            <a href="#" data-rel="back" class="ui-btn ui-corner-all ui-shadow ui-btn ui-icon-delete ui-btn-icon-notext ui-btn-right">Close</a>
            <form id = "signUp" method="post" action="#myPage">
                <h3>Register</h3>
                <label for="firstname" class="ui-hidden-accessible">Name </label>
                <input type="text" name="firstname" id="firstname" placeholder="Name" data-mini="true">
                <label for="email" class="ui-hidden-accessible">Email:</label>
                <input type="text" name="email" id="email" placeholder="Email" data-mini="true">
                <label for=pwd1 class="ui-hidden-accessible">Password: </label>
                <input type="text" name="pwd1" id="pwd1"placeholder="Password" data-mini="true">
                <label for="pwd2" class="ui-hidden-accessible">Confirm Password</label>
                <input type="text" name="pwd2" id="pwd2"  placeholder="Confirm Password" data-mini="true"><br>
                <input type="submit" data-inline="true" value="SignUp" data-mini="true">

            </form>
        </div>

    </div>


<!--myPage after loggin in-->
    <div data-role="page" id="myPage">
        <div id="header1" data-role="header">
            <h1>CrunchTime</h1>
            <span data-role="button" class="ui-btn ui-btn-right ui-corner-all ui-icon-bars ui-btn-icon-notext"style= "margin-top: 8px" onclick="menuContentShow()">Bars Icon</span>
            <ul class= "one nav-menu" data-role="listview" data-inset="true">
                <li data-icon="false"><a href="#homePage">Logout</a></li>
                <li data-icon="false"><a href="#homePage">Home</a></li>
                <li data-icon="false"><a href="#aboutUsPage">About Us</a></li>
            </ul>
            </div>
        <h3>Favorites</h3>
        <div class="ui-grid-x">

            <div class = "ui-block-a">
                <a href="#">
                    <img src="../www/img/burritoBowl.jpg" class="ui-li-thumb"></a><br>

                <span>Burrito Bowl<br> by <a href="#" >Chipotle</a></p></span>

            </div>
            <div class="ui-block-b"><a href="#">
                <img src="../www/img/taco.jpg" class="ui-li-thumb"></a></br>

                <span><p>Crispy Corn Tacos<br>by <a href="#">Taco Bell</a></p></span>

            </div>

        </div>


        <h3>Previously browsed</h3>

            <div class="ui-grid-x">


            <div class ="ui-block-a"><a href="#">
                <img src="../www/img/salad.jpg" class="ui-li-thumb"></a><br>

                <span><p>Salad Bowl<br> Prepared by <a href="#">You</a></p></span>

            </div>
            <div class="ui-block-b"><a href="#">
                <img src="../www/img/burger.jpg" class="ui-li-thumb"></a>

                <span><p>Burger<br>by <a href="#">McDonalds</a></p></span>

            </div>

        </div>

        </div>

<!--search page-->
    <div data-role="page" id="searchPage">
        <div id="header2" data-role="header">
        <h1>CrunchTime</h1>
            <span data-role="button" class="ui-btn ui-btn-right ui-corner-all ui-icon-bars ui-btn-icon-notext"style= "margin-top: 8px" onclick="menuContentShow()">Bars Icon</span>
            <ul class= "one nav-menu" data-role="listview" data-inset="true">
                <li data-icon="false"><a href="#loginPage">Login</a></li>
                <li data-icon="false"><a href="#signUpPage">Register</a></li>
                <li data-icon="false"><a href="#aboutUsPage">About Us</a></li>
            </ul>
        </div><br><br>
        <div data-role="main" content="ui-content">
            <form id="searchForm" method="post" action="#searchResultPage">

            <label><input type="radio" name="radio-choice-0" id="radio-choice-0a" data-mini="true">Vegan </label>
            <label for="radio-choice-0b">Vegetarian</label>
            <input type="radio" name="radio-choice-0" id="radio-choice-0b" class="custom" data-mini="true"><br>



                <div class="time2" content="ui-content">
                    <label for="time2">Time Preference</label></div>
                <div class="time2-o">
                    <select name="time2" id="time2" data-inline="true" data-mini="true">
                        <option value="30">30 mins</option>
                        <option value="15">15 mins</option>
                        <option value="45">45 mins</option>
                        <option value="1">1 hour</option>
                        <option value="1.15"> > 1 hour</option>

                    </select>
                </div><br><br>
            <label for="ingredient">Ingredients:</label>
            <input type="textarea" name="ingredient" id="ingredient"><br><br>


                <a href="#searchResultPage"><input type="submit" data-inline="true" value="Submit" data-mini="true"></a>

        </form>
            </div>


    </div>

<!--search result page-->
    <div data-role="page" id="searchResultPage">
        <div id="header3" data-role="header">
        <h1>CrunchTime</h1>
            <span data-role="button" class="ui-btn ui-btn-right ui-corner-all ui-icon-bars ui-btn-icon-notext"style= "margin-top: 8px" onclick="menuContentShow()">Bars Icon</span>
            <ul class= "one nav-menu" data-role="listview" data-inset="true">
                <li data-icon="false"><a href="#homePage">Logout</a></li>
                <li data-icon="false"><a href="#homePage">Home</a></li>
                <li data-icon="false"><a href="#aboutUsPage">About Us</a></li>
            </ul>
        </div>
        <h3>Search Result</h3>
        <div class="ui-grid-x">

            <div class = "ui-block-a">
                <a href="#">
                    <img src="../www/img/burritoBowl.jpg" class="ui-li-thumb"></a><br>

                <span>Burrito Bowl<br> by <a href="#" >Chipotle</a></p></span>

            </div>
            <div class="ui-block-b"><a href="#">
                <img src="../www/img/taco.jpg" class="ui-li-thumb"></a>

                <span><p>Crispy Corn Tacos<br>by <a href="#">Taco Bell</a></p></span>

            </div>
            <div class ="ui-block-a"><a href="#">
                <img src="../www/img/salad.jpg" class="ui-li-thumb"></a><br>

                <span><p>Salad Bowl<br> Prepared by <a href="#">You</a></p></span>

            </div>
            <div class="ui-block-b"><a href="#">
                <img src="../www/img/burger.jpg" class="ui-li-thumb"></a>

                <span><p>Burger<br>by <a href="#">McDonalds</a></p></span>

            </div>
        </div>
    </div>

<!--about us page-->
    <div data-role="page" id="aboutUsPage">
        <div id= "header4" data-role="header">
        <h1>CrunchTime</h1>
            <span data-role="button" class="ui-btn ui-btn-right ui-corner-all ui-icon-bars ui-btn-icon-notext"style= "margin-top: 8px" onclick="menuContentShow()">Bars Icon</span>
            <ul class= "one nav-menu" data-role="listview" data-inset="true">
                <li data-icon="false"><a href="#loginPage" data-rel="popup" data-position-to="window" data-transition="pop">Login</a></li>
                <li data-icon="false"><a href="#signUpPage" data-rel="popup" data-position-to="window" data-transition="pop">Register</a></li>
                <li data-icon="false"><a href="#homePage">Home</a></li>
            </ul>
        </div>
        <div data-role="main" content="ui-content">
            <h3>About Us</h3>

            <p id="p1">CrunchTime is for early stage professionals and graduate students who are short of time and need quick ideas to stay energized and productive. We gather food items and recipes which we recommend per your need.</p>
            <div data-role="main" content="ui-content">
                <div class="ui-grid-x">

                    <div class = "ui-block-a">
                            <img src="../www/img/2.jpg" class="ui-li-thumb"><br>
                            <span><p>Sonia Lin</p></span>
                    </div>
                    <div class="ui-block-b">
                        <img src="../www/img/1.jpg" class="ui-li-thumb">
                        <span><p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Chingari Patel</p></span>
                    </div>
                    </div>


         </div>
</div>
</div>
</body>
</html>
